<div id="forms" class="page-layout simple fullwidth" fxLayout="column">

    <!-- HEADER -->
    <div class="header accent p-24 h-160" fxLayout="row" fxLayoutAlign="start center">
        <div fxLayout="column" fxLayoutAlign="center start">
            <div class="h1 mt-16">Създаване на КРС Потребител</div>
        </div>
    </div>
    <!-- / HEADER -->

    <!-- CONTENT -->
    <div style="margin: 0 auto;" class="content p-24">


        <div class="mb-24" fxLayout="column" fxLayoutAlign="start" fxLayout.gt-md="row">

            <!-- REACTIVE FORM EXAMPLE -->

            <form class="mat-card mat-elevation-z4 p-24 mr-24" fxLayout="column" fxLayoutAlign="start" fxFlex="1 0 auto"
                name="form" [formGroup]="form">

                <div class="h1 mb-24">КРС Потребител</div>


                <h2 class="example-h2">Лични данни</h2>
                <div style="margin-bottom: 10px;">
                    <mat-divider></mat-divider>
                </div>
                <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

                    <mat-form-field appearance="outline" fxFlex="50" class="pr-4">
                        <mat-label>Име</mat-label>
                        <input matInput formControlName="firstName" required>
                        <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                        <mat-error>
                            Задължително поле
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                        <mat-label>Презиме</mat-label>
                        <input matInput formControlName="middleName" required>
                        <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                        <mat-error>
                            Задължително поле
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                        <mat-label>Фамилия</mat-label>
                        <input matInput formControlName="lastName" required>
                        <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                        <mat-error>
                            Задължително поле
                        </mat-error>
                    </mat-form-field>
                </div>

                <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
                    <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                        <mat-label>ЕГН</mat-label>
                        <input matInput formControlName="egn" required maxlength="10">
                        <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                        <mat-error *ngIf="form.get('egn').hasError('required')">
                            Задължително поле
                        </mat-error>
                        <mat-error *ngIf="form.get('egn').hasError('minlength')">
                            Моля въведете валиден ЕГН номер
                        </mat-error>
                    </mat-form-field>
                </div>

                <h2 class="example-h2">Потребителски данни</h2>
                <div style="margin-bottom: 10px;">
                    <mat-divider></mat-divider>
                </div>
                <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

                    <mat-form-field appearance="outline" fxFlex="50" class="pr-4">
                        <mat-label>Потребителско име</mat-label>
                        <input matInput formControlName="username" required>
                        <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                        <mat-error>
                            Задължително поле
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                        <mat-label>Парола</mat-label>
                        <input matInput formControlName="password" type="password" required>
                        <mat-icon matSuffix class="secondary-text">vpn_key</mat-icon>
                        <mat-error>
                            Задължително поле
                        </mat-error>
                    </mat-form-field>

                    <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                        <mat-label>Повтори парола</mat-label>
                        <input matInput formControlName="repeatPassword" type="password" required>
                        <mat-icon matSuffix class="secondary-text">vpn_key</mat-icon>
                        <mat-error *ngIf="form.get('repeatPassword').hasError('required')">
                            Задължително поле
                        </mat-error>
                        <mat-error *ngIf="form.get('repeatPassword').hasError('validate')">
                            Паролата не съвпада
                        </mat-error>
                    </mat-form-field>
                </div>
                <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

                    <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                        <mat-label>Електронна поща</mat-label>
                        <input matInput formControlName="email" required>
                        <mat-icon matSuffix class="secondary-text">mail</mat-icon>
                        <mat-error *ngIf="form.get('email').hasError('required')">
                            Задължително поле
                        </mat-error>
                        <mat-error *ngIf="form.get('email').hasError('email')">
                            Моля въведете валиден имейл адрес
                        </mat-error>
                    </mat-form-field>
                </div>

                <h2 class="example-h2">Активен от/до</h2>
                <div style="margin-bottom: 10px;">
                    <mat-divider></mat-divider>
                </div>
                <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

                    <mat-form-field fxFlex="50" class="pr-4">
                        <input matInput formControlName="activeFrom" [matDatepicker]="activeFrom" placeholder="Дата от">
                        <mat-datepicker-toggle matSuffix [for]="activeFrom"></mat-datepicker-toggle>
                        <mat-datepicker #activeFrom></mat-datepicker>
                        <mat-error>
                            Задължително поле
                        </mat-error>
                    </mat-form-field>


                    <mat-form-field fxFlex="50" class="pl-4">
                        <input matInput formControlName="activeTo" [matDatepicker]="activeTo" placeholder="Дата до">
                        <mat-datepicker-toggle matSuffix [for]="activeTo"></mat-datepicker-toggle>
                        <mat-datepicker #activeTo></mat-datepicker>
                        <mat-error>
                            Задължително поле
                        </mat-error>
                    </mat-form-field>


                    <mat-checkbox formControlName="userActivation" fxFlex="50" class="pl-4">Деактивирай потребител</mat-checkbox>

                </div>

                <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

                    <mat-card>
                        <mat-card-content>
                            <h2 class="example-h2">Роли</h2>
                            <ng-container fromArrayName="roles">
                                <section class="example-section">
                                    <div *ngFor="let role of roles; let i=index"> 
                                        <mat-checkbox [checked]="role.selected" [value]="role.value" class="example-margin" (change)="onCheckChange($event)"></mat-checkbox>
                                        {{role.desc}}
                                        
                                    </div>
                                    <mat-error *ngIf="(rolesValidation && form.get('roles').untouched)">
                                        Email is required
                                    </mat-error>
                                    <!-- <mat-checkbox formControlName="postRole" value="POST" class="example-margin">ЗПУ</mat-checkbox>
                                    <mat-checkbox formControlName="adminRole" value="ADMIN" class="example-margin">Администратор</mat-checkbox> -->
                                </section>
                            </ng-container>
                        </mat-card-content>
                    </mat-card>

                </div>

                <button class="create-user-btn" [disabled]="form.invalid" (click)="createOrUpdateCrcUser()" mat-raised-button color="accent">Запиши</button>
            </form>

            <!-- / REACTIVE FORM EXAMPLE -->

            <!-- <div class="mat-card form-errors-model p-24 mat-elevation-z4">
                <div class="h2 mb-24">Reactive Form Model</div>
                <pre><code>{{form.getRawValue() | json}}</code></pre>
            </div> -->

        </div>

    </div>

</div>
<!-- / CONTENT -->